package models;

/**
 * Fills gaps in voice transmission with silence.
 */
public class FillingStrategy extends GenericStrategy
{

    byte [] mWhiteNoise = {-6,-1,-20,-1,-21,-1,-22,-1,-6,-1,3,0,-2,-1,-9,-1,-3,-1,2,0,-1,-1,-2,-1,3,0,16,0,13,0,28,0,
            35,0,28,0,24,0,35,0,18,0,22,0,24,0,0,0,-5,-1,-10,-1,-2,-1,6,0,6,0,-8,-1,-7,-1,0,0,10,0,14,0,7,0,3,0,4,0,1,
            0,-4,-1,-8,-1,1,0,9,0,15,0,5,0,-8,-1,1,0,0,0,11,0,32,0,27,0,22,0,24,0,27,0,12,0,21,0,26,0,33,0,34,0,47,0,
            44,0,42,0,45,0,43,0,38,0,39,0,49,0,55,0,42,0,42,0,37,0,20,0,22,0,24,0,21,0,15,0,18,0,33,0,33,0,24,0,20,0,
            19,0,15,0,12,0,1,0,0,0,-7,-1,-8,-1,-9,-1,-7,-1,-9,-1,-7,-1,-7,-1,3,0,7,0,11,0,27,0,21,0,24,0,29,0,34,0,25,
            0,28,0,24,0,21,0,21,0,21,0,7,0,3,0,1,0,-6,-1,10,0,14,0,19,0,9,0,18,0,15,0,1,0,8,0,10,0,2,0,1,0,1,0,3,0,4,
            0,6,0,19,0,17,0,14,0,5,0,5,0,-8,-1,-20,-1,-24,-1,-25,-1,-33,-1,-25,-1,-15,-1,-27,-1,-26,-1,-31,-1,-25,-1,
            -16,-1,-20,-1,-22,-1,-11,-1,-1,-1,2,0,7,0,-10,-1,-19,-1,-26,-1,-32,-1,-26,-1,-18,-1,-33,-1,-23,-1,-24,-1,
            -30,-1,-26,-1,-29,-1,-25,-1,-41,-1,-50,-1,-40,-1,-57,-1,-57,-1,-53,-1,-45,-1,-32,-1,-19,-1,-11,-1,-15,-1,
            -24,-1,-17,-1,-14,-1,-12,-1,-14,-1,-28,-1,-24,-1,-28,-1,-42,-1,-44,0,-53,-1,-68,-1,-76,-1,-69,-1,-70,-1,
            -76,-1,-70,-1,-61,-1,-61,-1,-62,-1,-72,0,-85,-1,-70,-1,-58,-1,-52,-1,-51,-1,-62,-1,-56,-1,-49,-1,-42,-1,
            -39,-1,-33,-1,-30,-1,-22,-1,-20,-1,-23,-1,-16,-1,-11,-1,-6,-1,-6,-1,-16,-1,-18,-1,-1,-1,8,0,7,0,-2,-1,-3,
            -1,-9,-1,7,0,16,0,22,0,24,0,28,0,18,0,13,0,19,0,15,0,22,0,24,0,25,0,23,0,26,0,22,0,20,0,19,0,15,0,6,0,9,0,
            21,0,22,0,43,0,36,0,24,0,31,0,26,0,25,0,32,0,29,0,39,0,43,0,57,0,59,0,48,0,54,0};

    /**
     * Default constructor which calls GenericStrategy parent constructor.
     */
    public FillingStrategy()
    {
        super();
    }

    /**
     * Adds a packet to the FillingStrategy buffer.
     * @param packet The packet to be added to the buffer.
     */
    @Override
    public void addPacket(VoicePacket packet)
    {
        mVoiceVector.add(packet);
    }


    /**
     * Adds an empty packet to the buffer.
     * @return True if the buffer can continue being read.
     */
    @Override
    public boolean handlePacketLoss()
    {
        mVoiceVector.add(new VoicePacket(mVoiceVector.get(mVoiceVector.size()-1).getSequenceId()+1,
                mWhiteNoise, TransmissionType.VOICE));
        return true;
    }
}
